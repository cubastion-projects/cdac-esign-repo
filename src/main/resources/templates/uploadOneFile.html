<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorator="layout/adminLayout" lang="en" class="app"
	  xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<title>Upload One File</title>

	<link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
	<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
	<script src="https://code.jquery.com/jquery-1.11.1.js"></script>

	<style>
		body, html {
            height: 100%;
            margin: 0;
            background: url('/SpringBootESign/images/bg.jpg') no-repeat center center fixed;
            background-size: cover;
            font-family: Arial, sans-serif;
        }

        .modal-container {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            padding: 40px 50px;
            max-width: 700px;
            margin: 100px auto;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
        }

        h3 {
            text-align: center;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        input[type="button"] {
            width: 100%;
        }

        label {
            font-weight: 600;
        }

        .radio-group {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        input[type="radio"] {
            margin-right: 5px;
        }
	</style>

	<script type="text/javascript">
		function submitForm() {
            var form = $('#myForm')[0];
            var myUploadForm = new FormData($('#myForm')[0]);

            $.ajax({
                type: "POST",
                url: '/SpringBootESign/uploadMultiFile',
                data: myUploadForm,
                enctype: 'multipart/form-data',
                processData: false,
                contentType: false,
                xhrFields: { withCredentials: true },
                success: function (data) {
                    $('#eSignRequest').val(data.eSignRequest);
                    $('#aspTxnID').val(data.aspTxnID);
                    $("#formid").submit();
                },
                error: function (ts) {
                    alert("Hello frm js err");
                    alert("Error " + ts.responseText);
                }
            });
        }
	</script>
</head>

<body>

<div class="modal-container">
	<div style="display: flex; align-items: center; justify-content: center; gap: 15px;">
		<img src="" th:src="@{/images/jutesmartlogo.svg}" alt="" style="height: 50px;padding-bottom: 20px;" />
		<h4 style="
        color: #0A4E48;
        font-family: 'Poltawski Nowy', sans-serif !important;
        font-weight: 500;
        font-size: 30px;
        padding-bottom: 20px;">
			Jute Smart E-Sign
		</h4>
	</div>

	<form style="border-top: 1px solid green;padding-top: 20px;" name="myForm" id="myForm" th:object="${myUploadForm}" method="POST" enctype="multipart/form-data">
		<div class="form-group row">
			<label class="col-sm-4 control-label">File to upload:</label>
			<div class="col-sm-8">
				<input th:field="*{fileDatas}" type="file" name="file1" accept="application/pdf" required />
			</div>
		</div>

		<div class="form-group row">
			<label class="col-sm-4 control-label">Choose Authentication Type:</label>
			<div class="col-sm-8 radio-group">
				<label><input type="radio" name="auth" value="1" th:field="*{authType}" required /> OTP</label>
				<label><input type="radio" name="auth" value="2" th:field="*{authType}" /> Biometric</label>
			</div>
		</div>

		<div class="form-group row">
			<div class="col-sm-12 text-center">
				<input type="button" id="tryButtonClick" name="tryButtonClick" onclick="return submitForm();" value="Upload" class="btn btn-success" />
			</div>
		</div>
	</form>

	<form id="formid" name="formid" method="POST" action="https://es-staging.cdac.in/esignlevel2/2.1/form/signdoc">
		<input type="hidden" name="eSignRequest" id="eSignRequest" value="" />
		<input type="hidden" name="aspTxnID" id="aspTxnID" value="" />
		<input type="hidden" id="Content-Type" name="Content-Type" value="application/xml" />
	</form>
</div>

</body>
</html>